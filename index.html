<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè† House Head Chase - Survive the Walking Houses!</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Survive as long as you can while avoiding terrifying walking House Heads! Use your flashlight strategically in this thrilling survival game with power-ups and increasing difficulty. Free to play!">
    <meta name="keywords" content="survival game, house head chase, browser game, horror game, action game, flashlight, power-ups, free game, kids game, mobile game, PWA">
    <meta name="author" content="House Head Chase">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph Meta Tags (Dynamic URL) -->
    <meta property="og:title" content="üè† House Head Chase - Survive the Walking Houses!">
    <meta property="og:description" content="A thrilling survival game where you must avoid walking House Heads. Use your flashlight strategically and collect power-ups to survive as long as possible! Free to play in your browser.">
    <meta property="og:type" content="game">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="House Head Chase - Survival Horror Game Screenshot">
    <meta property="og:site_name" content="House Head Chase">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="üè† House Head Chase">
    <meta name="twitter:description" content="Survive the walking House Heads in this thrilling browser game! Free to play, works offline!">
    <meta name="twitter:image" content="">
    <meta name="twitter:image:alt" content="House Head Chase Game Screenshot">
    <meta name="twitter:site" content="@HouseHeadChase">
    <meta name="twitter:creator" content="@HouseHeadChase">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#ff4444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="House Head Chase">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="House Head Chase">
    <meta name="msapplication-TileColor" content="#ff4444">
    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons - Complete set -->
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="icons/icon-48.png">
    <link rel="icon" type="image/png" sizes="96x96" href="icons/icon-96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="apple-touch-icon" sizes="57x57" href="icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-icon-180x180.png">
    <link rel="apple-touch-icon" href="icons/apple-icon.png">
    
    <!-- Critical CSS -->
    <style>
        /* Critical inline styles for faster loading */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background: #000;
            color: #fff;
            overflow: hidden;
        }
        
        .hidden {
            display: none !important;
        }
        
        .game-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            z-index: 100;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn.primary {
            background: linear-gradient(45deg, #ff4444, #ff6644);
            color: white;
        }
        
        .btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 68, 68, 0.4);
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        #gameCanvas {
            border: 2px solid #333;
            cursor: crosshair;
            touch-action: none;
        }
        
        /* HUD Styles */
        #hud {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .hud-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .hud-label {
            font-size: 11px;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        
        .hud-value {
            font-size: 16px;
            color: #fff;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        #healthBar {
            width: 100px;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }
        
        #healthFill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ffaa44);
            width: 100%;
            transition: width 0.3s ease;
        }
        
        /* Time-focused styling */
        .hud-time .hud-value {
            font-size: 18px;
            color: #ffaa44;
            text-shadow: 0 0 10px rgba(255, 170, 68, 0.5);
            font-weight: 900;
            letter-spacing: 1px;
        }
        
        .hud-time .hud-label {
            color: #ffaa44;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link" tabindex="1" style="position: absolute; top: -40px; left: 0; background: #000; color: #fff; padding: 8px; text-decoration: none; z-index: 10000;">Skip to main content</a>
    
    <!-- Error Boundary Container -->
    <div id="errorBoundary" class="hidden" role="alert" aria-live="assertive" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9998; display: flex; align-items: center; justify-content: center;">
        <div class="error-content" style="background: #222; padding: 30px; border-radius: 10px; text-align: center; max-width: 400px;">
            <h2 style="color: #ff4444; margin: 0 0 15px 0;">üö® Oops! Something went wrong</h2>
            <p id="errorMessage" style="color: #ccc; margin-bottom: 20px;">The game encountered an unexpected error.</p>
            <div class="error-actions">
                <button class="btn primary" onclick="window.location.reload()" style="margin: 5px;">üîÑ Reload Game</button>
                <button class="btn secondary" onclick="reportError()" style="margin: 5px; background: #666; color: white;">üìß Report Issue</button>
            </div>
        </div>
    </div>
    
    <!-- Game Container -->
    <div id="gameContainer" style="position: relative; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center;">
        <canvas id="gameCanvas" 
                width="800" 
                height="600"
                aria-label="House Head Chase Game Canvas" 
                role="application"
                tabindex="0"
                style="max-width: 100%; max-height: 100%; background: #000;">
            Your browser doesn't support HTML5 Canvas. Please upgrade to a modern browser to play House Head Chase!
        </canvas>
        
        <!-- HUD - Game Interface -->
        <div id="hud" class="hidden" role="toolbar" aria-label="Game HUD">
            <div class="hud-item">
                <span class="hud-label">Health</span>
                <div id="healthBar" 
                     role="progressbar" 
                     aria-valuemin="0" 
                     aria-valuemax="100" 
                     aria-valuenow="100"
                     aria-label="Player health">
                    <div id="healthFill"></div>
                </div>
                <span id="health" class="hud-value" aria-live="polite">100</span>
            </div>
            
            <div class="hud-item hud-time">
                <span class="hud-label">Time</span>
                <span class="hud-value" id="survivalTime" aria-live="polite">0:00</span>
            </div>
            
            <div class="hud-item">
                <span class="hud-label">Level</span>
                <span class="hud-value" id="level" aria-live="polite">1</span>
            </div>
            
            <button id="audioToggle" 
                    class="audio-btn" 
                    aria-label="Toggle game audio" 
                    title="Toggle Sound"
                    style="background: transparent; border: 1px solid #666; color: #fff; padding: 8px; border-radius: 4px; cursor: pointer;">üîä</button>
        </div>
        
        <!-- Active Power-ups Display -->
        <div id="powerupIndicators" 
             class="hidden" 
             aria-live="polite" 
             aria-label="Active power-ups"
             style="position: fixed; top: 100px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1001;">
        </div>
        
        <!-- Flashlight Status -->
        <div id="flashlightIndicator" 
             class="hidden" 
             aria-live="polite"
             style="position: fixed; bottom: 20px; left: 20px; background: rgba(0,0,0,0.7); padding: 8px 12px; border-radius: 6px; color: #ffaa44;">
            <span class="flashlight-icon" aria-hidden="true">üî¶</span>
            <span class="flashlight-text">LIGHT ON</span>
        </div>
        
        <!-- Tutorial Hints -->
        <div id="controlsHint" 
             class="controls-hint hidden" 
             role="tooltip"
             style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); padding: 10px 20px; border-radius: 8px; font-size: 14px; text-align: center;">
            üî¶ DOUBLE TAP for flashlight ‚Ä¢ üì± Drag blue dot to move ‚Ä¢ üí° Use light strategically!
        </div>
        
        <!-- Performance Monitor (Development) -->
        <div id="performanceMonitor" class="hidden dev-only" style="position: fixed; top: 10px; right: 10px; font-size: 12px; color: #666;">
            FPS: <span id="fpsCounter">60</span> | 
            Enemies: <span id="enemyCount">0</span> |
            Memory: <span id="memoryUsage">0MB</span>
        </div>
    </div>
    
    <!-- Start Screen -->
    <div id="startScreen" class="game-screen" role="main" id="main-content">
        <header class="start-header" style="text-align: center; margin-bottom: 30px;">
            <h1 style="font-size: 3em; margin: 0; background: linear-gradient(45deg, #ff4444, #ffaa44); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">üè† HOUSE HEAD CHASE</h1>
            <p class="tagline" style="font-size: 1.2em; color: #ff6644; margin: 10px 0;">Survival Horror Game!</p>
        </header>
        
        <div class="game-preview" style="text-align: center; margin: 30px 0;">
            <div class="preview-icon" style="font-size: 4em; margin-bottom: 15px;">üè†</div>
            <p class="preview-text">
                <strong style="color: #ffaa44;">FREE TO PLAY!</strong><br>
                <span style="color: #ccc;">Survive the walking houses!</span>
            </p>
        </div>
        
        <div class="instructions" style="max-width: 500px; text-align: center; margin: 20px;">
            <div class="instruction-group">
                <h3 style="color: #ffaa44; margin-bottom: 15px;">üéØ HOW TO SURVIVE:</h3>
                <p style="margin: 8px 0; line-height: 1.4;">üîµ <strong>You are the blue dot</strong> - Stay alive!</p>
                <p style="margin: 8px 0; line-height: 1.4;">üì± <strong>Drag to move</strong> ‚Ä¢ <strong>Double tap for flashlight</strong></p>
                <p style="margin: 8px 0; line-height: 1.4;">üè† <strong>House Heads</strong> spawn and hunt you down!</p>
                <p style="margin: 8px 0; line-height: 1.4;">‚ö° <strong>Collect power-ups</strong> for special abilities!</p>
                <p style="margin: 8px 0; line-height: 1.4;">üî¶ <strong>Use your flashlight wisely</strong> - it attracts enemies!</p>
            </div>
        </div>
        
        <div class="button-container" style="display: flex; flex-direction: column; align-items: center; gap: 15px; margin-top: 30px;">
            <button class="btn primary pulse" 
                    id="startGameBtn" 
                    aria-label="Start new game"
                    style="font-size: 18px; padding: 15px 30px; animation: pulse 2s infinite;">
                üéÆ START GAME
            </button>
            <div class="secondary-buttons" style="display: flex; gap: 15px;">
                <button class="btn secondary" 
                        id="showHighScoresBtn" 
                        aria-label="View high scores"
                        style="background: #333; color: white; padding: 10px 20px;">
                    üèÜ SCORES
                </button>
                <button class="btn secondary" 
                        id="showHelpBtn" 
                        aria-label="Show game instructions"
                        style="background: #333; color: white; padding: 10px 20px;">
                    ‚ùì HELP
                </button>
            </div>
        </div>
    </div>
    
    <!-- Game Over Screen -->
    <div id="gameOver" class="game-screen hidden" role="dialog" aria-labelledby="gameOverTitle">
        <h2 id="gameOverTitle" style="color: #ff4444; font-size: 2.5em; margin-bottom: 10px;">üíÄ GAME OVER!</h2>
        <p class="game-over-message" style="color: #ccc; font-size: 1.2em; margin-bottom: 30px;">üè† The House Heads got you!</p>
        
        <div class="stats-container" style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; margin-bottom: 30px;">
            <div class="stats" role="group" aria-label="Final game statistics" style="display: flex; justify-content: center; align-items: center; gap: 30px;">
                <div class="stat-item stat-primary" style="text-align: center; background: rgba(255, 170, 68, 0.15); border: 2px solid rgba(255, 170, 68, 0.4); border-radius: 8px; padding: 15px 20px;">
                    <span class="stat-label" style="display: block; color: #ffaa44; font-weight: 700; font-size: 12px; margin-bottom: 8px;">‚è∞ SURVIVED</span>
                    <span class="stat-value" id="finalTime" style="display: block; font-size: 24px; color: #ffaa44; text-shadow: 0 0 10px rgba(255, 170, 68, 0.5); font-weight: 900;">0:00</span>
                </div>
                <div class="stat-item" style="text-align: center; padding: 15px 20px;">
                    <span class="stat-label" style="display: block; color: #ccc; font-weight: 600; font-size: 12px; margin-bottom: 8px;">üìä LEVEL</span>
                    <span class="stat-value" id="finalLevel" style="display: block; font-size: 20px; color: #fff; font-weight: bold;">1</span>
                </div>
            </div>
            
            <!-- Achievement Notification Area -->
            <div id="achievementNotification" class="achievement-notification hidden" style="margin-top: 15px; text-align: center;">
                <div class="achievement-content" style="background: linear-gradient(45deg, #ffaa44, #ff6644); color: white; padding: 10px 20px; border-radius: 8px; display: inline-flex; align-items: center; gap: 10px;">
                    <span class="achievement-icon">üèÖ</span>
                    <span class="achievement-text">New Personal Best!</span>
                </div>
            </div>
        </div>
        
        <div class="button-container" style="display: flex; flex-direction: column; align-items: center; gap: 15px;">
            <button class="btn primary pulse" 
                    id="restartGameBtn" 
                    aria-label="Play again"
                    style="font-size: 18px; padding: 15px 30px;">
                üîÑ PLAY AGAIN
            </button>
            <div class="secondary-buttons" style="display: flex; gap: 15px;">
                <button class="btn secondary" 
                        id="shareScoreBtn" 
                        aria-label="Share your score"
                        style="background: #333; color: white; padding: 10px 20px;">
                    üì§ SHARE
                </button>
                <button class="btn secondary" 
                        id="showStartScreenBtn" 
                        aria-label="Return to main menu"
                        style="background: #333; color: white; padding: 10px 20px;">
                    üè† MENU
                </button>
            </div>
        </div>
    </div>
    
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content" style="text-align: center;">
            <div class="loading-house" style="font-size: 4em; margin-bottom: 20px; animation: bounce 1s infinite;">üè†</div>
            <h2 style="color: #fff; margin-bottom: 20px;">Loading House Head Chase...</h2>
            <div class="loading-bar" style="width: 200px; height: 4px; background: #333; border-radius: 2px; overflow: hidden; margin: 20px auto;">
                <div class="loading-fill" style="height: 100%; background: linear-gradient(90deg, #ff4444, #ffaa44); width: 0%; animation: loadingAnimation 2s ease-in-out infinite;"></div>
            </div>
            <p class="loading-text" style="color: #999; font-size: 14px;">Preparing your survival experience...</p>
        </div>
    </div>
    
    <!-- CSS Animations -->
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes loadingAnimation {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        .powerup-indicator {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #ffaa44;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            animation: pulse 1s infinite;
        }
        
        /* Responsive design */
        @media (max-width: 800px) {
            #gameCanvas {
                width: 100vw !important;
                height: 100vh !important;
                max-width: none !important;
                max-height: none !important;
            }
            
            #hud {
                top: 10px;
                left: 10px;
                right: 10px;
                padding: 8px 10px;
            }
            
            .hud-item {
                font-size: 14px;
            }
            
            .hud-value {
                font-size: 14px;
            }
            
            .hud-time .hud-value {
                font-size: 16px;
            }
        }
        
        @media (max-width: 600px) {
            .stats {
                flex-direction: row !important;
                gap: 15px;
            }
            
            .stat-primary {
                flex: 2;
            }
            
            .stat-item:not(.stat-primary) {
                flex: 1;
            }
        }
    </style>
    
    <!-- Analytics & Performance Tracking -->
    <script>
        // Initialize configuration and analytics
        window.addEventListener('load', () => {
            // Dynamic URL setup for meta tags
            const currentUrl = window.location.href;
            const imageUrl = new URL('icons/social-preview.png', currentUrl).href;
            
            // Update meta tags with current URL
            const ogUrlMeta = document.querySelector('meta[property="og:url"]');
            const ogImageMeta = document.querySelector('meta[property="og:image"]');
            const twitterImageMeta = document.querySelector('meta[name="twitter:image"]');
            
            if (ogUrlMeta) ogUrlMeta.content = currentUrl;
            if (ogImageMeta) ogImageMeta.content = imageUrl;
            if (twitterImageMeta) twitterImageMeta.content = imageUrl;
            
            // Performance tracking
            const timing = performance.timing;
            if (timing) {
                const loadTime = timing.loadEventEnd - timing.navigationStart;
                console.log(`üöÄ Page loaded in ${loadTime}ms`);
                
                // Track performance metrics
                if (window.gtag) {
                    gtag('event', 'page_performance', {
                        'page_load_time': loadTime,
                        'dom_content_loaded': timing.domContentLoadedEventEnd - timing.navigationStart
                    });
                }
            }
            
            // Hide loading screen with animation
            const loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen) {
                setTimeout(() => {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 500);
                }, 1000);
            }
        });
        
        // Global error handler
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            showErrorBoundary(event.error?.message || 'Unknown error occurred');
            
            // Track errors
            if (window.gtag) {
                gtag('event', 'exception', {
                    'description': event.error?.message || 'Unknown error',
                    'fatal': false
                });
            }
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Unhandled promise rejection:', event.reason);
            showErrorBoundary('Promise rejection: ' + (event.reason?.message || 'Unknown promise error'));
        });
        
        // Error boundary functions
        function showErrorBoundary(message) {
            const errorBoundary = document.getElementById('errorBoundary');
            const errorMessage = document.getElementById('errorMessage');
            
            if (errorBoundary && errorMessage) {
                errorMessage.textContent = message;
                errorBoundary.classList.remove('hidden');
            }
        }
        
        function reportError() {
            const errorMessage = document.getElementById('errorMessage')?.textContent || 'Unknown error';
            const subject = encodeURIComponent('House Head Chase - Error Report');
            const body = encodeURIComponent(`Error Details:\n${errorMessage}\n\nBrowser: ${navigator.userAgent}\nURL: ${window.location.href}\nTime: ${new Date().toISOString()}`);
            window.open(`mailto:support@househeadchase.com?subject=${subject}&body=${body}`);
        }
        
        // Accessibility helpers
        function announceToScreenReader(message) {
            const announcement = document.createElement('div');
            announcement.setAttribute('aria-live', 'polite');
            announcement.setAttribute('aria-atomic', 'true');
            announcement.className = 'sr-only';
            announcement.style.cssText = 'position: absolute; left: -10000px; width: 1px; height: 1px; overflow: hidden;';
            announcement.textContent = message;
            document.body.appendChild(announcement);
            
            setTimeout(() => {
                if (document.body.contains(announcement)) {
                    document.body.removeChild(announcement);
                }
            }, 1000);
        }
        
        // Placeholder functions until game.js loads
        window.startGame = window.startGame || function() { console.log('Starting game...'); };
        window.restartGame = window.restartGame || function() { console.log('Restarting game...'); };
        window.goToStartScreen = window.goToStartScreen || function() { console.log('Going to start screen...'); };
        window.showHighScores = window.showHighScores || function() { console.log('Showing high scores...'); };
        window.closeHighScores = window.closeHighScores || function() { console.log('Closing high scores...'); };
        window.showHelp = window.showHelp || function() { console.log('Showing help...'); };
        window.closeHelp = window.closeHelp || function() { console.log('Closing help...'); };
        window.showShareModal = window.showShareModal || function() { console.log('Showing share modal...'); };
        window.closeShareModal = window.closeShareModal || function() { console.log('Closing share modal...'); };
        window.soundSystem = window.soundSystem || { toggle: function() { console.log('Toggling sound...'); } };
        window.installPWA = window.installPWA || function() { console.log('Installing PWA...'); };
        window.hideInstallPrompt = window.hideInstallPrompt || function() { console.log('Hiding install prompt...'); };
    </script>
    
    <!-- Load configuration first -->
    <script src="config.js"></script>
    <!-- Load main game -->
    <script src="game.js"></script>
    <!-- Load analytics (will be loaded from config) -->
    <script src="analytics.js"></script>
</body>
</html>
